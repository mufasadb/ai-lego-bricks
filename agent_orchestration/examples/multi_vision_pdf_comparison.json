{
  "name": "multi_vision_pdf_comparison",
  "description": "Compare different vision models' analysis of the same PDF document",
  "config": {
    "default_llm_provider": "gemini"
  },
  "steps": [
    {
      "id": "process_pdf_traditional",
      "type": "document_processing",
      "description": "Extract text from PDF using traditional methods",
      "config": {
        "enhance_with_llm": false
      },
      "inputs": {
        "file_path": "$pdf_path"
      },
      "outputs": ["text", "page_count"]
    },
    {
      "id": "process_pdf_with_vision_fallback",
      "type": "document_processing", 
      "description": "Extract text from PDF with vision fallback enabled",
      "config": {
        "enhance_with_llm": false,
        "use_vision_fallback": true,
        "llm_provider": "gemini"
      },
      "inputs": {
        "file_path": "$pdf_path"
      },
      "outputs": ["text", "enhanced_text", "vision_text"]
    },
    {
      "id": "force_gemini_vision_general",
      "type": "document_processing",
      "description": "Force Gemini Vision processing with general prompt",
      "config": {
        "force_vision_processing": true,
        "llm_provider": "gemini",
        "vision_prompt": "Analyze this document and extract all the key information including any financial data, dates, and important details. Provide a comprehensive summary."
      },
      "inputs": {
        "file_path": "$pdf_path"
      },
      "outputs": ["vision_text", "processing_method"]
    },
    {
      "id": "force_gemini_vision_tables",
      "type": "document_processing",
      "description": "Force Gemini Vision processing focused on tables",
      "config": {
        "force_vision_processing": true,
        "llm_provider": "gemini",
        "extract_tables": true
      },
      "inputs": {
        "file_path": "$pdf_path"
      },
      "outputs": ["vision_text", "processing_method"]
    },
    {
      "id": "force_gemini_vision_financial",
      "type": "document_processing",
      "description": "Force Gemini Vision processing focused on financial data",
      "config": {
        "force_vision_processing": true,
        "llm_provider": "gemini",
        "vision_prompt": "Focus on extracting financial information from this document. Look for amounts, dates, invoice numbers, billing details, payment terms, and any other financial data. Format the output clearly."
      },
      "inputs": {
        "file_path": "$pdf_path"
      },
      "outputs": ["vision_text", "processing_method"]
    },
    {
      "id": "output_traditional_text",
      "type": "file_output",
      "description": "Save traditional text extraction results",
      "config": {
        "file_path": "output/traditional_extraction.txt",
        "format": "text",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "from_step": "process_pdf_traditional",
          "field": "text"
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "output_vision_fallback",
      "type": "file_output", 
      "description": "Save vision fallback results",
      "config": {
        "file_path": "output/vision_fallback_results.json",
        "format": "json",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "traditional_text": {"from_step": "process_pdf_with_vision_fallback", "field": "text"},
          "vision_text": {"from_step": "process_pdf_with_vision_fallback", "field": "vision_text"},
          "enhanced_text": {"from_step": "process_pdf_with_vision_fallback", "field": "enhanced_text"}
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "output_gemini_general",
      "type": "file_output",
      "description": "Save Gemini Vision general analysis",
      "config": {
        "file_path": "output/gemini_vision_general.txt",
        "format": "text",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "from_step": "force_gemini_vision_general",
          "field": "vision_text"
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "output_gemini_tables",
      "type": "file_output",
      "description": "Save Gemini Vision table extraction",
      "config": {
        "file_path": "output/gemini_vision_tables.txt",
        "format": "text",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "from_step": "force_gemini_vision_tables",
          "field": "vision_text"
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "output_gemini_financial",
      "type": "file_output",
      "description": "Save Gemini Vision financial analysis",
      "config": {
        "file_path": "output/gemini_vision_financial.txt", 
        "format": "text",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "from_step": "force_gemini_vision_financial",
          "field": "vision_text"
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "create_comparison_summary",
      "type": "file_output",
      "description": "Create a summary comparing all extraction methods",
      "config": {
        "file_path": "output/comparison_summary.json",
        "format": "json",
        "create_dirs": true
      },
      "inputs": {
        "content": {
          "pdf_path": "$pdf_path",
          "extraction_methods": {
            "traditional": {
              "method": "PyMuPDF traditional extraction",
              "result_file": "output/traditional_extraction.txt",
              "text_length": {"from_step": "process_pdf_traditional", "field": "text"}
            },
            "vision_fallback": {
              "method": "Traditional with Gemini Vision fallback",
              "result_file": "output/vision_fallback_results.json",
              "vision_used": {"from_step": "process_pdf_with_vision_fallback", "field": "vision_processing_used"}
            },
            "gemini_general": {
              "method": "Gemini Vision - General Analysis", 
              "result_file": "output/gemini_vision_general.txt",
              "processing_method": {"from_step": "force_gemini_vision_general", "field": "processing_method"}
            },
            "gemini_tables": {
              "method": "Gemini Vision - Table Extraction",
              "result_file": "output/gemini_vision_tables.txt",
              "processing_method": {"from_step": "force_gemini_vision_tables", "field": "processing_method"}
            },
            "gemini_financial": {
              "method": "Gemini Vision - Financial Focus",
              "result_file": "output/gemini_vision_financial.txt", 
              "processing_method": {"from_step": "force_gemini_vision_financial", "field": "processing_method"}
            }
          }
        }
      },
      "outputs": ["file_path", "success"]
    },
    {
      "id": "final_output",
      "type": "output",
      "description": "Return summary of all processing results",
      "inputs": {
        "summary": "Multi-vision PDF comparison completed successfully",
        "results_directory": "output/",
        "comparison_file": {"from_step": "create_comparison_summary", "field": "file_path"},
        "pdf_processed": "$pdf_path"
      }
    }
  ]
}